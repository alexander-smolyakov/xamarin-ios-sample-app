steps:

- task: Bash@3
  displayName: 'Set Xamarin & Mono'
  inputs:
    targetType: filePath
    filePath: src/xamarin-ios/select-xamarin.sh
    arguments: ${{ parameters.XAMARIN_SYMLINK }}

- task: Bash@3
  displayName: 'Set Xcode'
  inputs:
    targetType: filePath
    filePath: src/xamarin-ios/select-xcode.sh
    arguments: ${{ parameters.XCODE_VERSION }}

- task: UseDotNet@2
  displayName: 'Switch .NET Core version'
  inputs:
    version: ${{ parameters.NETCORE_VERSION }}

- task: CmdLine@2
  displayName: 'Restore Nuget'
  inputs:
    script: nuget restore $(build.sourcesdirectory)/src/xamarin-ios/xamarin-test-app/xamarin-test-app.sln

- task: XamariniOS@1
  displayName: 'Build Xamarin.iOS solution'
  inputs:
    solutionFile: '$(build.sourcesdirectory)/src/xamarin-ios/xamarin-test-app/xamarin-test-app.sln'
    configuration: Release
    packageApp: False
    buildForSimulator: True
    runNugetRestore: false
    args: '/t:Rebuild '
    buildToolOption: msbuild
